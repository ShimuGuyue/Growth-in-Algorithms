# 题目描述

[F-小红的排列构造_牛客周赛 Round 111](https://ac.nowcoder.com/acm/contest/117763/F)

![image-20250929215301925](%E5%B0%8F%E7%BA%A2%E7%9A%84%E6%8E%92%E5%88%97%E6%9E%84%E9%80%A0.assets/image-20250929215301925.png)

# 解题思路

> 对于每个置换环，将其复原所需的次数为元素个数减一。

将数组变为升序的结果只有一种情况，$\forall i, a_i = i$。

首先考虑无解的情况，最优操作下，每次操作至少使一个元素归位，且最后一次操作必定使两个元素归位，因此**操作次数至多为 $n - 1$**；最优排列情况下，每次操作至多使两个元素归位，因此**操作数至少为 $\lceil \frac{n}{2} \rceil$**。若题目所给 $k$ 值不在次区间内则无解。

可以将整个数组分成**左中右**三个部分 **(L, M, R)**，其中 $L$ 部分和 $R$ 部分长度相等 **$(len_{out} <= \lfloor \frac{n}{2} \rfloor)$**，对于这两个区域需保证每次操作都能使两个元素归位，即 $\forall i, j \in [1, len_{out}] \cup [n - len_{out} + 1, n], a_i = j, a_j = i$，**该部分归位的花费为 $len_{out}$**；对于 $M$ 部分 **$(len_{in} = n - len_{out} \times 2)$**，将内部元素在保证一次只能归位一个元素的前提下进行排列，**该部分的花费为 $len_{in} - 1$**。二者相加最终得到**总花费为 $n - len_{out} - 1$**。

在 $k$ 的约束条件下，$\forall k \in [\lceil \frac{n}{2} \rceil, n - 1]$，$len_{out}$ 总是有解。解除 $len_{out}$ 的长度之后，对三部分分别构造即可。

# 代码实现

![image-20250929215803379](%E5%B0%8F%E7%BA%A2%E7%9A%84%E6%8E%92%E5%88%97%E6%9E%84%E9%80%A0.assets/image-20250929215803379.png)